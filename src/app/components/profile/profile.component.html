<app-nav-links class="nav"></app-nav-links>

<div class="user">
  <div class="user__icon-and-name">
    <svg class="user__icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40px"
      height="40px" viewBox="0 0 40 40" version="1.1" stroke="#000">
      <g id="surface1">
        <path style="
            fill: none;
            stroke-width: 40;
            stroke-linecap: butt;
            stroke-linejoin: miter;
            stroke-opacity: 1;
            stroke-miterlimit: 4;
          "
          d="M 564.961163 300.00012 C 564.961163 446.367366 446.367366 564.961163 300.00012 564.961163 C 153.632874 564.961163 35.039077 446.367366 35.039077 300.00012 C 35.039077 153.632874 153.632874 35.039077 300.00012 35.039077 C 446.367366 35.039077 564.961163 153.632874 564.961163 300.00012 Z M 564.961163 300.00012 "
          transform="matrix(0.0666666,0,0,0.0666666,0,0)" />
        <path style="
            fill: none;
            stroke-width: 40;
            stroke-linecap: butt;
            stroke-linejoin: miter;
            stroke-opacity: 1;
            stroke-miterlimit: 4;
          "
          d="M 414.961103 230.039155 C 414.961103 293.554805 363.51577 345.000138 300.00012 345.000138 C 236.48447 345.000138 185.039137 293.554805 185.039137 230.039155 C 185.039137 166.523504 236.48447 114.960983 300.00012 114.960983 C 363.51577 114.960983 414.961103 166.523504 414.961103 230.039155 Z M 414.961103 230.039155 "
          transform="matrix(0.0666666,0,0,0.0666666,0,0)" />
        <path style="
            fill: none;
            stroke-width: 40;
            stroke-linecap: butt;
            stroke-linejoin: miter;
            stroke-opacity: 1;
            stroke-miterlimit: 4;
          "
          d="M 106.816449 481.406443 C 135.820367 399.609535 213.222742 345.000138 300.00012 345.000138 C 386.777498 345.000138 464.179873 399.609535 493.183791 481.406443 "
          transform="matrix(0.0666666,0,0,0.0666666,0,0)" />
      </g>
    </svg>

    <h2 *ngIf="!editMode" class="user__name">
      {{ customer.firstName }} <br />
      {{ customer.lastName }}
    </h2>

    <app-button *ngIf="!editMode && !changePassMode" (click)="switchToEditMode()" text="Edit"></app-button>
    <app-button *ngIf="editMode" (click)="saveFormChanges()" text="Save"></app-button>

    <app-button *ngIf="!editMode && !changePassMode" (click)="switchToChangePassMode()"
      text="Change password"></app-button>
    <app-button *ngIf="changePassMode" (click)="savePasswordChanges()" text="Change password"></app-button>
    <app-button *ngIf="changePassMode" (click)="exitChangePassMode()" text=" Back"></app-button>
  </div>

  <div *ngIf="!editMode && !changePassMode" class="user__data">
    <!-- email -->
    <div class="user__data-item">
      <div>
        <h3 class="user__data-heading">Email</h3>
        <span class="user__data-content">{{ customer.email }}</span>
      </div>
    </div>

    <!-- date of birth -->
    <div class="user__data-item">
      <div>
        <h3 class="user__data-heading">Date of birth</h3>
        <span class="user__data-content">{{ customer.dateOfBirth }}</span>
      </div>
    </div>

    <!-- shipping address -->
    <div *ngFor="let shippingAddress of customer.shippingAddresses; let i = index" class="user__data-item">
      <div>
        <h3 class="user__data-heading shipping">Address</h3>
        <span class="user__data-content">
          {{ shippingAddress.postalCode }}, {{ shippingAddress.country }}, {{ shippingAddress.city }},
          {{ shippingAddress.streetName }}, {{ shippingAddress.streetNumber }}
        </span>
      </div>
    </div>

    <!-- billing address -->
    <div *ngFor="let billingAddress of customer.billingAddresses; let i = index" class="user__data-item">
      <div>
        <h3 class="user__data-heading billing">Address</h3>
        <span class="user__data-content">{{ billingAddress.postalCode }}, {{ billingAddress.country }}, {{
          billingAddress.city }},
          {{ billingAddress.streetName }}, {{ billingAddress.streetNumber }}
        </span>
      </div>
    </div>
  </div>

  <!-- Edit mode form -->
  <div *ngIf="editMode" class="user__data" [ngClass]="{ 'user__data_edit-mode': editMode }">
    <!-- first name -->
    <div class="user__data-item" [ngClass]="{ 'user__data-item_edit-mode': editMode }">
      <h3 class="user__data-heading">First name</h3>
      <input (blur)="validateFirstNameInput()" [(ngModel)]="customer.firstName" class="user__data-content"
        [ngClass]="{ 'invalid-input': isInvalid.firstName }" type="text" />
      <span class="invalid-msg" *ngIf="isInvalid.firstName"> {{ isInvalid.firstName }}</span>
    </div>

    <!-- last name -->
    <div class="user__data-item" [ngClass]="{ ' user__data-item_edit-mode': editMode }">
      <h3 class="user__data-heading">Last name</h3>
      <input (blur)="validateLastNameInput()" [(ngModel)]="customer.lastName" class="user__data-content"
        [ngClass]="{ 'invalid-input': isInvalid.lastName }" type="text" />
      <span class="invalid-msg" *ngIf="isInvalid.lastName"> {{ isInvalid.lastName }}</span>
    </div>

    <!-- email -->
    <div class="user__data-item" [ngClass]="{ 'user__data-item_edit-mode': editMode }">
      <h3 class="user__data-heading">Email</h3>
      <input (blur)="validateEmailInput()" [(ngModel)]="customer.email" class="user__data-content"
        [ngClass]="{ 'invalid-input': isInvalid.email }" type="text" />
      <span class="invalid-msg" *ngIf="isInvalid.email"> {{ isInvalid.email }}</span>
    </div>

    <!-- date of birth -->
    <div class="user__data-item" [ngClass]="{ 'user__data-item_edit-mode': editMode }">
      <h3 class="user__data-heading">Date of birth</h3>
      <input (blur)="validateDateOfBirthInput()" [(ngModel)]="customer.dateOfBirth" class="user__data-content"
        [ngClass]="{ 'invalid-input': isInvalid.dateOfBirth }" type="date" />
      <span class="invalid-msg" *ngIf="isInvalid.dateOfBirth"> {{ isInvalid.dateOfBirth }}</span>
    </div>

    <!-- shipping address -->
    <div *ngFor="let shippingAddress of customer.shippingAddresses" class="user__data-item"
      [ngClass]="{ 'user__data-item_edit-mode': editMode }">
      <h3 class="user__data-heading shipping">Address</h3>

      <h4 class="user__data-heading user__data-heading_edit-mode">Postal Code</h4>
      <input class="user__data-content" [(ngModel)]="shippingAddress.postalCode" type="text" />

      <h4 class="user__data-heading user__data-heading_edit-mode">Country</h4>
      <select class="user__data-content" [(ngModel)]="shippingAddress.country">
        <option *ngFor="let country of countries" [value]="country.code">{{ country.name }}</option>
      </select>

      <h4 class="user__data-heading user__data-heading_edit-mode">City</h4>
      <input class="user__data-content" [(ngModel)]="shippingAddress.city" type="text" />

      <h4 class="user__data-heading user__data-heading_edit-mode">Street</h4>
      <input class="user__data-content" [(ngModel)]="shippingAddress.streetName" type="text" />

      <h4 class="user__data-heading user__data-heading_edit-mode">Building</h4>
      <input class="user__data-content" [(ngModel)]="shippingAddress.streetNumber" type="text" />
    </div>

    <!-- billing addresses -->
    <div *ngFor="let billingAddress of customer.billingAddresses" class="user__data-item"
      [ngClass]="{ 'user__data-item_edit-mode': editMode }">
      <h3 class="user__data-heading billing">Address</h3>

      <h4 class="user__data-heading user__data-heading_edit-mode">Postal Code</h4>
      <input class="user__data-content" [(ngModel)]="billingAddress.postalCode" type="text" />

      <h4 class="user__data-heading user__data-heading_edit-mode">Country</h4>
      <select class="user__data-content" [(ngModel)]="billingAddress.country">
        <option *ngFor="let country of countries" [value]="country.code">{{ country.name }}</option>
      </select>

      <h4 class="user__data-heading user__data-heading_edit-mode">City</h4>
      <input class="user__data-content" [(ngModel)]="billingAddress.city" type="text" />

      <h4 class="user__data-heading user__data-heading_edit-mode">Street</h4>
      <input class="user__data-content" [(ngModel)]="billingAddress.streetName" type="text" />

      <h4 class="user__data-heading user__data-heading_edit-mode">Building</h4>
      <input class="user__data-content" [(ngModel)]="billingAddress.streetNumber" type="text" />
    </div>
  </div>

  <!-- Change pass mode form -->
  <div *ngIf="changePassMode" class="user__data">
    <!-- Old pass -->
    <div class="user__data-item user__data-item_edit-mode">
      <h3 class="user__data-heading">Current password</h3>
      <input (blur)="validatePassCurrentInput()" [(ngModel)]="customer.password.current" class="user__data-content"
        [ngClass]="{ 'invalid-input': isPasswordInvalid.current }" type="password" />
      <span class="invalid-msg" *ngIf="isPasswordInvalid.current"> {{ isPasswordInvalid.current }}</span>
    </div>
    <!-- New pass -->
    <div class="user__data-item user__data-item_edit-mode">
      <h3 class="user__data-heading">New password</h3>
      <input (blur)="validatePassNewInput()" [(ngModel)]="customer.password.new" class="user__data-content"
        [ngClass]="{ 'invalid-input': isPasswordInvalid.new }" type="password" />
      <span class="invalid-msg" *ngIf="isPasswordInvalid.new"> {{ isPasswordInvalid.new }}</span>
    </div>
  </div>
</div>